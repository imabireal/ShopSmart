<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShopSmart - Admin/Seller Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <header class="admin-header">
        <div class="admin-header container">
            <h1>ShopSmart Admin</h1>
            <nav class="admin-nav">
                <span>Welcome, {{ current_user.username }}</span>
                <a href="{{ url_for('product.home') }}">Store</a>
                <a href="{{ url_for('auth.logout') }}">Logout</a>
            </nav>
        </div>
    </header>

    <main class="admin-container">
        <div class="flex justify-between items-center mb-6">
            <h2 class="admin-section-title">Product Management</h2>
            <a href="{{ url_for('product.admin_seller_add_product') }}" class="btn-admin-primary">
                + Add New Product
            </a>
        </div>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="message {% if category == 'success' %}message-success{% else %}message-error{% endif %} mb-4">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        {% if products %}
        <div class="admin-card">
            <div class="admin-card-body">
                <div class="admin-table-container">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Price</th>
                                <th>Source</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for product in products %}
                            <tr>
                                <td>{{ product.id }}</td>
                                <td>
                                    {{ product.name }}
                                    {% if product.is_seller_product %}
                                    <span class="admin-badge admin-badge-seller">Seller: {{ product.seller }}</span>
                                    {% endif %}
                                </td>
                                <td>₹{{ "%.2f"|format(product.price) }}</td>
                                <td>
                                    {% if product.is_seller_product %}
                                    <span class="admin-badge admin-badge-seller">Seller Product</span>
                                    {% else %}
                                    <span class="admin-badge admin-badge-main">Main Catalog</span>
                                    {% endif %}
                                </td>
                                <td class="admin-action-buttons">
                                    <a href="{{ url_for('product.admin_seller_edit_product', product_id=product.id) }}"
                                       class="admin-btn-small admin-btn-edit">
                                        Edit
                                    </a>
                                    <a href="{{ url_for('product.admin_seller_delete_product', product_id=product.id) }}"
                                       class="admin-btn-small admin-btn-delete"
                                       onclick="return confirm('Are you sure you want to delete this product?')">
                                        Delete
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        {% else %}
        <div class="admin-card">
            <div class="admin-empty-state">
                <p>No products found. Add your first product!</p>
            </div>
        </div>
        {% endif %}

        {% if seller_products %}
        <div class="mt-8">
            <h3 class="text-xl font-bold mb-4">Seller Products Overview</h3>
            {% for seller, products in seller_products.items() %}
            <div class="admin-seller-section">
                <h4>{{ seller }} ({{ products|length }} products)</h4>
                <ul>
                    {% for product in products %}
                    <li>{{ product.name }} - ₹{{ "%.2f"|format(product.price) }}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endfor %}
        </div>
        {% endif %}
    </main>
</body>
</html>

